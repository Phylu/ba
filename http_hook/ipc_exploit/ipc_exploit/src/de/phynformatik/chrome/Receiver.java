package de.phynformatik.chrome;

import java.io.UnsupportedEncodingException;

import android.app.Activity;
import android.content.ComponentName;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;

public class Receiver extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
     
        // Get data from intent
        Intent call = getIntent();
        String refer = call.getData().toString();
        
        // Set the model of the devie
        String model = "";
		try {
			model = java.net.URLEncoder.encode(android.os.Build.MODEL, "utf-8");
		} catch (UnsupportedEncodingException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

        // Prepare the server url containing the model and the original url where the user will be redirected to
        String url = String.format("http://home.in.tum.de/~maierj/ba/?data=%s&refer=%s", model, refer); 
        
        // Create intent and give to chrome explicitly
        Intent i = new Intent("android.intent.action.MAIN");
        i.setComponent(ComponentName.unflattenFromString("com.android.chrome/com.android.chrome.Main"));
        i.addCategory("android.intent.category.LAUNCHER");
        i.setData(Uri.parse(url));
        startActivity(i);
        
        // Close the activity before it is fully displayed, so it will never be visible to the user
        finish();
        
    }
    
    

    
    
}